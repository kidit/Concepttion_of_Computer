1. 데이터링크 프로토콜의 분류

    1. 종류

        1. 비동기식 프로토콜 
        
            1. 송신 측과 수신 측 간에 기계적 클록의 동기화 없이 데이터 전송을 이룸

            2. 수신 측 : 추가된 비트 확인 -> 데이터 부분만 추출

            3. PC 통신 : 파일 전송에 필요한 프로토콜 -> 윈도 방식 사용

                1. 송신 측 : 수신 측 응답 기다리지 않음 -> 다음 프레임을 연속적으로 전송함

                    1. 전송 효율이 높아짐

        2. 동기식 프로토콜

            1. 문자 위주 프로토콜 = 바이트 위주 프로토콜

                1. 프레임 = 1 바이트 구성하는 문자들의 연속적인 열로 간주

                2. 모든 제어 정보 -> ASCII 문자와 같은 기존 문자 부호화 시스템의 형태를 갖춤

                3. 효율이 낮음 -> 현재 거의 사용하지 않음

            2. 비트 위주 프로토콜

                1. 전송 프레임 = 비트열로 간주

                2. 오늘날 사용하는 비트 위주 프로토콜 -> HDLC 기반으로 만들어짐

                    1. HDLC

                        1. 점대점과 다중점 링크상에서 반이중, 전이중 통신 지원하는 동기식 프로토콜

                        2. 슬라이딩 윈도 방식 사용 -> 흐름 제어

                        3. Go - back - N ARQ, 선택적 ARQ -> 오류 제어

                        관련 용어

                            1. 주국 : 점대점, 다중점 회선 구성 -> 링크의 모든 제어권을 갖는 장치

                            2. 보조국 : 주국의 제어 -> 주국의 명령에 따라 응답을 보냄

                            3. 복합국 : 명령, 응답 모두 발생시킬 수 있는 스테이션이자 대동 장치 중 하나

                            4. 불균형 구성 
                            
                                1. 1개의 장치만 주국이고 나머지가 보조국이 됨

                                2. 불균형 구성 : 대부분 컴퓨터 1 대가 여러 주변 장치를 제어하는 형태인 다중점 구성임

                            5. 대칭 구성
                                
                                1. 링크상의 물리적인 스테이션 -> 주국, 보조국 2개의 논리적 스테이션으로 이루어짐

                                2. 불균형 구성과 동일하게 동작
                                    
                                    1. 2개의 스테이션 간에 링크의 제어권이 이동할 수 있다.
                            
                            6. 균형 구성 

                                1. 2개의 스테이션이 대등한 관계로 동작하는 구성

                                2. 단일 회선으로 연결되어 있음 -> 두 스테이션에 의해 제어될 수 있음
                        
                        동작 모드

                            1. 정규 응답 모드 ( NRM )

                                1. 주국 - 보조국 관계

                                2. 보조국 : 전송하기 전 반드시 주국에게 허락을 받아야 함

                                    1. 허락 받은 후 -> 보조국 : 응답 프레임 전송
                                    
                                        1. 해당 프레임 : 주국으로 보내는 데이터가 포함될 수 있음
                            
                            2. 비동기 응답 모드 (ARM)

                                1. 링크가 사용되고 있지 않을 때 -> 보조국 : 주국 허락 없이 전송 시작

                                2. 주국 - 보조국 관계 변경 X

                                    1. 보조국에서 보낸 모든 데이터 -> 주국으로 전송 -> 주국 : 최종 목적지로 중계
                            
                            3. 비동기 균형 모드 (ABM)

                                1. 주국 - 보조국 관계 X -> 동등한 권한이 있는 복합국 : 점대점으로 연결한 경우 사용

                                2. 모든 복합국 -> 허락 없이 다른 복합국에 전송 시작 가능

                        프레임 구조

                            1. I - 프레임 = 정보 프레임 : 사용자 데이터 및 관련된 제어 정보 전달

                                동작 과정

                                    1. 확장 모드 설정 : SNRME, SARME, SABME 사용 -> 순서 번호 : 7비트

                                    2. 데이터 링크 해제 과정
                                        
                                        1. DISC 프레임 -> 보조국 전달

                                        2. 수신 측 : UA로 응답
                                    
                                    3. 전이중 데이터 전송

                                        1. 복합국 간에 논리적인 연결이 이루어짐 -> 데이터 전송 단계가 됨

                                        2. 흐름 제어 + 오류 제어 수행 -> I - 프레임 교환
                                    
                                    4. RNR을 이용한 흐름 제어권

                                        1. HDLC -> 슬라이딩 윈도에 의한 흐름 제어 + RNR을 이용한 흐름 제어도 병행 수행

                                            1. 수신 스테이션의 버퍼가 넘치지 않도록 하기 위함

                                    5. REJ를 이용한 오류 제어

                                        1. I 프레임에 오류 발생 시 -> 타임아웃, REJ 명령어 이용 -> 오류 복구

                                    6. 주국 - 보조국 사이의 폴링에 의한 데이터 전송

                                        1. HDLC 동작 -> 정규 응답 모드가 되어야 함

                                            1. 주국 -> SNRM 명령 -> 보조국 전송 : 링크 설정 요구

                                            2. 보조국 -> SNRM 명령 수신 : UA 응답 보냄

                                                1. 링크 동작 관련된 모든 변수 카운터 초기값 설정
                                            
                                            3. 주국, 보조국 간 논리적 링크 설정 -> 데이터 교환
                                    
                                    7. 주국 - 보조국 사이의 셀렉션에 의한 데이터 전송

                                        1. 주국 -> 보조국으로부터 RNR 보냄 : 주국이 받지 않고 보낼 것을 알림

                                            1. I - 프레임 이용 -> 프레임 전송

                                        2. 보조국 -> RR로 수신 준비가 도었음을 알림

                                            1. 보조국 -> 주국의 신호에 응답함


                            2. S - 프레임 = 감시 프레임

                                1. 제어 정보만 전달하는데 사용

                                2. 흐름 제어, 오류 제어를 위한 제어 정보로 전달

                                3. 정보 필드가 없음

                                프레임 명령 및 응답

                                    1. RR (receive Ready)

                                        1. S - 프레임을 수신할 준비가 되어 있음을 알림

                                        2. 프레임 수신을 확인할 때 쓰임

                                        3. RNR 명령 -> 프레임 수신 거절 시 : RR 사용 -> 프레임 수신 가능

                                        4. 주국 -> 보조국 폴링 가능
                            
                                    2. RNR

                                        1. busy 상태 -> 더 이상 프레임을 수신할 수 없다는 수신 거부 명령

                                        2. N(R) 사용 -> 이전에 수신한 프레임에 대해 수신 확인 가능 
                                    
                                    3. REJ : N(R) 이후 모든 프레임에 대해 재전송 요구

                                    4. SREJ (selective Reject) : 특정 프레임 재전송 요구 -> 재전송할 프레임 번호 : N(R) 필드에 실음

                            3. U - 프레임 = 무번호 프레임

                                1. 시스템 관리를 위해 예약된 것

                                2. 링크 설정 , 해제, 오류 회복 -> 링크 자체를 관리하는 정보 전달

                                프레임 명령 및 응답

                                    1. SNRM 
                                        
                                        1. 링크 연결 -> 정규 응답 모드 설정 -> 보조국에 요청함

                                        2. 주국 -> 링크상의 모든 제어 담당

                                    2. SNRME 

                                        1. 제어 필드 : 16비트 확장

                                        2. SNRM 모드 설정 -> 보조국 요청

                                        3. 확장 모드 : 순서 번호 = 7비트 사용

                                    3. SARM 

                                        1. 링크 연결 : 비동기 응답 모드 설정 -> 보조국 요청

                                        2. 주국의 폴링 없이 보조국은 프레임 전송 가능

                                    4. SARME

                                        1. 제어필드 16비트 확장

                                        2. SARM 모드로 설정할 것을 보조국에 요청

                                        3. 확장 모드 : 순서 번호 = 7비트 사용
                                    
                                    5. DM : 보조국 -> 주국 연결 해제 상태임을 알릴 때 사용

                                    6. UI : 독립적인 프레임 하나 전달할 때 사용

                                    7. UA : 명령에 응답할 때 사용 -> busy 상태 종결 알림

                                    8. DISC : 주국 -> 보조국에 데이터링크 연결 해제 요구 -> UA 응답 대기

                                    9. RD : 보조국 -> 주국에 데이터리읔 연결 해제 요구

                                    10. SIM : 주국 <-> 보조국 세션 초기화, UA 응답 대기

                                    11. RUM : 보조국 -> 주국에 SIM 명령 요구

                                    12. UP : 주국 -> 보조국 폴링

                                    13. RST 
                                    
                                        1. 현재 링크에 문제가 있을 경우 초기화

                                        2. 송신 스테이션 : N(S)

                                        3. 수신 스테이션 : N(R) = 0 리셋

                                    14. XID : 보조국 인증 -> 질의하는 것

                                    15. FRMR : 프레임 수신한 쪽 -> 프레임 형식 문제 발생 -> 상대 측에 이유 기록 및 전달

                                    16. TEST 
                                    
                                        1. 링크 상태 시험 -> 보조국에 응답 요청

                                        2. 보조국 : 동일한 데이터로 응답

                        프레임 필드 종류

                            1. Flag
                                
                                1. 프레임의 시작과 끝을 나타냄

                                2. 8비트로 구성

                                3. 수신 측 동기화하는데 사용

                                4. BSC -> SYN 같은 역할 수행
                            
                            2. Address

                                1. 프레임 송신, 수신하는 보조국 식별을 위한 주소 필드

                                2. 주국 송신 -> 프레임을 수신하는 목적지 보조국의 주소가 됨

                                3. 보조국 송신 -> 프레임을 송신하는 보조국의 주소가 됨
                            
                            3. Control

                                1. 데이터 흐름을 제어하는 필드

                                2. 제어 필드 1번째, 2번째 프레임 -> I, S, U - 프레임 구분

                                    1. 1번째 비트 0 : I - 프레임

                                    2. 1번째, 2번째 비트 -> 0, 1 : S - 프레임

                                    3. 1번째, 2번째 비트 -> 1, 1 : U - 프레임

                            4. Information

                                1. 실제로 전송할 데이터를 포함한 필드

                                2. I - 프레임 : 데이터 외 흐름 제어, 오류 제어 등의 정보를 넣을 수 있음

                                    1. 피기백킹 : I - 프레임에 제어 정보를 합쳐서 보내는 것
                                
                            5. FCS 

                                1. 수신할 프레임 -> 오류 발생했는지 검사하기 위한 필드

                                2. CRC를 사용함

                                    1. CRC 연산 결과로 나온 나머지 -> FCS 필드에 넣어서 보냄

                        제어 필드를 구성하는 각 비트의 의미

                            1. N(S) : 현재 전송하는 프레임 순서 번호

                            2. N(R) : 다음에 전송 받기 원하는 프레임 순서 번호

                            3. P/F : 폴 or 마지막 프레임인지 표시 + 송신 받은 후 어느 한 쪽이라도 수신하지 않으면 다른 쪽에서 수신하지 못함

                                1.  P 비트

                                    1. 명령 프레임에 표시

                                    2. 보조국, 상대 복합국에 응답을 요구하는 데 사용
                                
                                2. F 비트

                                    1. 응답 프레임 표시

                            4. Code : HDLC 명령 / 응답에 대한 2진 코드
                        
            4. 비트 스터핑

                1. 동작 흐름도

                    1. 0 이후 1이 연속적으로 5번 나올 때 -> 스터핑 루틴으로 돌아감

                    2. 7번째 비트 조사

                        1. 7번째 비트 0 : 3번으로

                        2. 7번째 비트 1 : 4로 이동

                    3. 그 부분이 데이터 부분 -> 이전 5개의 1을 데이터로 받아들임 -> 현재 0을 제거함

                        1. 비트 스터핑 끝냄 -> 수신 프레임을 계속 읽음

                    4. 8번째 비트 조사

                        1. 8번째 비트 0 : 5번

                        2. 8번째 비트 1 : 6번
                                
                    5. 플래그로 받아들임 -> 수신 프레임 계속 읽음

                    6. 0이 나올 때 까지 계속 읽음

                    7. 계속 읽음 -> (7 <= (2 bit) 1 < 15) -> 중지 상태 인식

                    8. 1이 15개 이상 나오는 경우 -> 휴지 상태로 인식            

